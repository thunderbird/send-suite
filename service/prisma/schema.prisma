generator client {
  provider = "prisma-client-js"
  binaryTargets = ["native"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}


model User {
  id      Int     @id @default(autoincrement())
  email   String  @unique
  links   Link[]
}

// Content that is stored on a filesystem
// It can be shared with other pro-users via Groups, or it can
// be shared with non-users via Links
model Upload {
  id        String      @unique
  links   Link[]

  owner     String
  metadata  String
  dlimit    Int
  auth      String
  nonce     String
  pwd    Boolean
  // dl     Int
  createdAt DateTime?
}

// A Link is how we share to a non-user.
//
model Link {
  id            String    @unique
  upload        Upload    @relation(fields: [uploadId], references: [id])
  uploadId      String
  sharedBy      Int       @map("shared_by")
  user          User      @relation(fields: [sharedBy], references: [id])
  pwHash        String
  downloadLimit Int?
  createdAt     DateTime?
  expiresAt     DateTime?
}